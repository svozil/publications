\documentclass[%
 %reprint,
 %superscriptaddress,
 %groupedaddress,
 %unsortedaddress,
 %runinaddress,
 %frontmatterverbose,
 preprint,
 showpacs,
 showkeys,
 preprintnumbers,
 %nofootinbib,
 %nobibnotes,
 %bibnotes,
 amsmath,amssymb,
 aps,
 % prl,
 pra,
 % prb,
 % rmp,
 %prstab,
 %prstper,
  longbibliography,
 %floatfix,
 %lengthcheck,%
 ]{revtex4-1}

\usepackage[breaklinks=true,colorlinks=true,anchorcolor=blue,citecolor=blue,filecolor=blue,menucolor=blue,pagecolor=blue,urlcolor=blue,linkcolor=blue]{hyperref}
\usepackage{graphicx}% Include figure files
\usepackage{bm}% bold math
\usepackage{eepic}
\usepackage[x11names]{xcolor}
%\bibpunct{[}{]}{,}{a}{}{;}

%\usepackage{pslatex}
\begin{document}
%\sloppy



\title{Chocolate cryptography}

\author{Karl Svozil}
\email{svozil@tuwien.ac.at}
\homepage{http://tph.tuwien.ac.at/~svozil}
\affiliation{Institute for Theoretical Physics, Vienna University of Technology,  \\ Wiedner Hauptstra\ss e 8-10/136, A-1040 Vienna, Austria}

\begin{abstract}
Some quantum cryptographic protocols can be implemented with specially prepared chocolate balls, others protected by value indefiniteness cannot. This latter feature, which follows from Bell- and Kochen-Specker type arguments, is only present in systems with three or more mutually exclusive outcomes. Conversely, there exist chocolate ball configurations utilizable for cryptography which cannot be realized by quantum systems.
\end{abstract}

\pacs{03.67.Hk,03.65.Ud}
\keywords{Quantum information, quantum cryptography, singlet states, entanglement, quantum nonlocality, value indefiniteness, contextuality}




\maketitle

\section{Quantum resources for cryptography}

Quantum cryptography~\footnote{
In view of the many superb presentations of quantum cryptography
--- to name but a few, see Refs.~\cite{gisin-qc-rmp,arXiv:0802.4155}  and
\cite[Chapter~6]{mermin-04} (or, alternatively, \cite[Section 6.2]{mermin-07}),
as well as
\cite[Section~12.6]{nielsen-book};
apologies to other authors for this incomplete, subjective collection
---
I refrain from any extensive introduction.
}
uses quantum resources to encode plain symbols forming some message.
Thereby, the security of the code against cryptanalytic attacks to recover
that message rests upon the validity of physics, giving new and direct meaning to
Landauer's dictum~\cite{landauer} ``information is physical.''

What exactly are those quantum resources on which quantum cryptography is based upon?
Consider, for a start,  the following qualities of quantized systems:
\renewcommand{\labelenumi}{(\roman{enumi})}
\begin{enumerate}
\item
randomness of certain individual events,
such as the occurrence of certain measurement outcomes
for states which are in a  superposition of eigenstates
associated with eigenvalues corresponding to these outcomes;
\item
complementarity, as proposed by Pauli, Heisenberg and Bohr;
\item
value indefiniteness, as attested by Bell, Kochen \& Specker, Greenberger, Horne and Zeilinger, and others
(often, this property is referred to as ``contextuality''~\cite{bohr-1949,bell-66,redhead}.
Alas, contextual truth assignments
are just one possibility among others to cope with the theorems mentioned,
thereby providing a particular quasi-realistic, but not necessarily the only possible, ``solution'' or ``interpretation'' of those theorems~\cite{svozil-2008-ql});
\item
interference and quantum parallelism, allowing the co-representation of classically contradicting states of information
by a coherent superposition thereof;
\item
entanglement of two or more particles,
as pointed out by Schr\"odinger, such that their state cannot be represented
as the product of states of the isolated, individual quanta,
but is rather defined by the {\em joint} or {\em relative} properties of the quanta involved.
\end{enumerate}

The first quantum cryptographic protocols, such as the ones by Wiesner~\cite{wiesner} and
Bennett \& Brassard~\cite{benn-84,benn-92},
just require complementarity and random individual outcomes.
This might be perceived ambivalently as an advantage -- by being based upon only these two features --
yet at the same time not utilizing the full mind boggling capacities of quantum mechanics, since they are not ``protected''
(in terms of no-go theorems for local noncontextual nonexotic~\cite{pitowsky-82,meyer:99}
hidden variable models not allowing)
by Bell- or Kochen-Specker type~\cite{specker-60,kochen1,ZirlSchl-65,Alda,Alda2,kamber64,kamber65,mermin-93}
value indefiniteness.

This article addresses two issues: a critical re-evaluation
of quantum cryptographic protocols in view
of quantum value indefiniteness;
as well as suggestions to improve them to assure the best possible protection
``our''~\cite[p.~866]{born-26-1} present quantum theory can afford.
In doing so, a toy model will be introduced which implements complementarity but still
is value definite.
Then it will be exemplified how to do perform ``quasi-classical'' quantum-like cryptography
with these models.
Finally, methods will be discussed which go beyond the quasi-classical realm.

Even nowadays it is seldom acknowledged that,
when it comes to value definiteness, there definitely {\em is} a difference between
two- and three-dimensional Hilbert space.
This difference can probably be best explained in terms of (conjugate) bases:
whereas different bases in two-dimensional Hilbert space are disjoint and totally separated
(they do not share any vector),
from three dimensions onwards, they may share common elements.
It is this inter-connectedness of bases and ``frames'' which
supports both the Gleason and the Kochen-Specker theorems.
This can, for instance, be used in derivations of the latter one in three dimensions,
which effectively amount to a succession of rotations of bases along one of their elements
(the original Kochen-Specker~\cite{kochen1} proof uses 117 interlinked bases), thereby creating new rotated bases,
until the original base is reached.
Note that certain (even dense~\cite{meyer:99}) ``dilutions'' of bases break up the possibility to interconnect,
thus allowing value definiteness.

The importance of these arguments for physics is this:
since in quantum mechanics the dimension of Hilbert space
is determined by the number of mutually exclusive outcomes,
a {\em necessary} condition for a quantum system to be protected by value indefiniteness
thus is that the associated quantum system has {\em at least three} mutually exclusive outcomes;
two outcomes are insufficient for this purpose.
Of course, one could argue that systems with two outcomes are still protected by complementarity.

\section{Realizations of quantum cryptographic protocols}

Let us, for the sake of demonstration,
discuss a concrete ``toy'' system which features complementarity but (not) value (in)definiteness.
It is based on the partitions of a set.
Suppose the set is given by
$S=\{1,2,3,4\}$,
and consider two of its equipartitions
$A=\{\{1,2\},\{3,4\}\}$
and
$B=\{\{1,3\},\{2,4\}\}$, as well as
the usual set theoretic operations (intersection, union and complement) and
the subset relation among the elements of these two partitions.
Then $A$ and $B$ generate two Boolean algebras
$L_A= \{\emptyset ,\{1,2\},\{3,4\},S\}$
and
$L_B= \{\emptyset ,\{1,3\},\{2,4\},S\}$
which are equivalent to a Boolean algebra with two atoms
$a_1=\{1,2\}$ \& $a_2=\{3,4\}$, as well as
$b_1=\{1,3\}$  \& $b_2=\{2,4\}$
per algebra, respectively.
Then, the partition logic~\cite{svozil-ql,svozil-2001-eua,svozil-2008-ql}
consisting of two Boolean subalgebras
$L_A \oplus L_B = L_{A,B} = \left\langle \{L_A,L_B\},\cap, \cup, ',\subset \right\rangle $
is obtained as a pasting construction (through identifying identical elements of subalgebras~\cite{greechie:71,nav:91,kalmbach-81})
from $L_A$ and $L_B$:
only elements contribute which are in $L_A$, or in $L_B$, or in both of them  (i.e. in $L_A \cap L_B$)
-- the atoms of this algebra being the elements  $a_1,\ldots ,b_2$ --
and all common elements. In the present case only the smallest and greatest elements $\emptyset$
and $S$  --  are identified.
$L_{A,B}$ ``inherits'' the operations and relations of its subalgebras (also called {\em blocks}
or {\em contexts}) $L_A$ and $L_B$.
This pasting construction yields a nondistributive and thus
nonboolean, orthocomplemented propositional structure~\cite{kalmbach-81,pulmannova-91}.
Nondistributivity can quite easily be proven,
as  $a_1 \wedge (b_1 \vee b_2) \neq  (a_1 \wedge b_1) \vee (a_1 \wedge b_2)$,
since $b_1 \vee b_2=S$, whereas  $a_1 \wedge b_1= a_1 \wedge b_2 =\emptyset$.
Note that, although $a_1,\ldots ,b_2$ are compositions of elements of $S$,
not all elements of the power set  of $S$ associated with a Boolean algebra with four atoms,  such
as $\{1\}$ or $\{1,2,3\}$, are contained in $L_{A,B}$.

Figure~\ref{2006-ql-nondist}(a)
depicts a Greechie (orthogonality) diagram~\cite{greechie:71} of  $L_{A,B}$,
which represents elements in a Boolean algebra as single smooth curves;
in this case there are just two atoms  (least elements above $\emptyset$)
per subalgebra; and both subalgebras are not interconnected.
\begin{figure}
\begin{center}
\begin{tabular}{ccc}
%TexCad Options
%\grade{\off}
%\emlines{\off}
%\beziermacro{\off}
%\reduce{\on}
%\snapping{\off}
%\quality{0.20}
%\graddiff{0.01}
%\snapasp{1}
%\zoom{1.00}
\unitlength 0.35mm
\allinethickness{1.5pt} %\thicklines %\linethickness{0.4pt}
\begin{picture}(165,65.00)
\put(0.00,15.00){\color{DeepPink1}\circle{6}}
\put(0.00,15.00){\color{DeepPink1}\circle{2.8}}
\put(0.00,15.00){\color{DeepPink1}\circle{0.5}}
\put(60.00,15.00){\color{DeepPink1}\circle{6}}
\put(60.00,15.00){\color{DeepPink1}\circle{2.8}}
\put(60.00,15.00){\color{DeepPink1}\circle{0.5}}
\put(0.00,0.00){\color{DeepPink1}\makebox(0,0)[cc]{$a_1=a_2'$}}
\put(60.00,0.00){\color{DeepPink1}\makebox(0,0)[cc]{$a_2=a_1'$}}
\put(0.00,15.00){\color{DeepPink1}\line(1,0){60.00}}
\put(100.00,15.00){\color{Turquoise1}\circle{6}}
\put(100.00,15.00){\color{Turquoise1}\circle{2.8}}
\put(100.00,15.00){\color{Turquoise1}\circle{0.5}}
\put(160.00,15.00){\color{Turquoise1}\circle{6}}
\put(160.00,15.00){\color{Turquoise1}\circle{2.8}}
\put(160.00,15.00){\color{Turquoise1}\circle{0.5}}
\put(110.00,0.00){\color{Turquoise1}\makebox(0,0)[cc]{$b_2=b_1'$}}
\put(160.00,0.00){\color{Turquoise1}\makebox(0,0)[cc]{$b_1=b_2'$}}
\put(100.00,15.00){\color{Turquoise1}\line(1,0){60.00}}
\put(40.00,25.00){\color{DeepPink1}\makebox(0,0)[cc]{$L_A$}}
\put(130.00,25.00){\color{Turquoise1}\makebox(0,0)[cc]{$L_B$}}
\end{picture}
&
\qquad
\qquad
\qquad
&
%TeXCAD Picture [1.pic]. Options:
%\grade{\off}
%\emlines{\off}
%\epic{\off}
%\beziermacro{\off}
%\reduce{\on}
%\snapping{\off}
%\quality{6.000}
%\graddiff{0.010}
%\snapasp{1}
%\zoom{9.5137}
\unitlength .55mm % = 1.707pt
\allinethickness{1.5pt} %\thicklines %\linethickness{0.4pt}
\ifx\plotpoint\undefined\newsavebox{\plotpoint}\fi % GNUPLOT compatibility
\begin{picture}(69.971,40.225)(0,0)
\put(29.971,.225){\color{DeepPink1}\vector(0,1){40}}
\put(29.971,.225){\color{DeepPink1}\vector(1,0){40}}
\put(29.971,.225){\color{Turquoise1}\vector(1,1){30}}
\put(29.943,.225){\color{Turquoise1}\vector(-1,1){30}}
\put(30,45){\color{DeepPink1}\makebox(0,0)[cc]{$a_1=a_2'$}}
\put(69.971,-4.775){\color{DeepPink1}\makebox(0,0)[cc]{$a_2=a_1'$}}
\put(60,35){\color{Turquoise1}\makebox(0,0)[cc]{$b_2=b_1'$}}
\put(0,35){\color{Turquoise1}\makebox(0,0)[]{$b_1=b_2'$}}
\end{picture}
\\
$\;$\\
(a)&&(b)
\end{tabular}
\end{center}
\caption{\label{2006-ql-nondist}
(Color online)
(a) Greechie
diagram  of $L_{A,B}$, consisting of two separate Boolean subalgebras $L_A$ and $L_B$;
(b)
two-dimensional configuration of spin-$\frac{1}{2}$
state measurements along two noncollinear directions.
As there are only two mutually exclusive outcomes, the dimension of the Hilbert space is two.
}
\end{figure}

Several realizations of this partition logic exist; among them
\begin{enumerate}
\item
the propositional structure~\cite{birkhoff-36,svozil-ql} of spin state measurements of a spin-$\frac{1}{2}$ particle
along two noncollinear directions,
or of the linear polarization of a photon along two nonorthogonal, noncollinear directions.
A  two-dimensional Hilbert space representation of this configuration is depicted in
Figure~\ref{2006-ql-nondist}(b).
Thereby, the choice of the measurement direction decides which one of the two
complementary spin state observables is measured;
\item
generalized urn models~\cite{wright,dvur-pul-svo}
utilizing
black balls painted
with two or more symbols in two or more colors.
Suppose, for instance,  just two symbols ``$0$'' and ``$1$''
in just two colors, say,  ``pink'' and ``light blue'',
resulting in four types of conceivable balls:
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(8,8) \put(4,2){\circle*{8}} \put(4,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 0}}{\color{Turquoise1} {\bf 0}}$}} \end{picture},
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(8,8) \put(4,2){\circle*{8}} \put(4,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 0}}{\color{Turquoise1} {\bf 1}}$}} \end{picture},
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(8,8) \put(4,2){\circle*{8}} \put(4,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 1}}{\color{Turquoise1} {\bf 0}}$}} \end{picture}, as well as
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(8,8) \put(4,2){\circle*{8}} \put(4,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 1}}{\color{Turquoise1} {\bf 1}}$}} \end{picture}
--- many copies of which are randomly
distributed in an urn.
Suppose further that the experimenter looks at them with one of two differently colored eyeglasses,
each one ideally  matching the colors of only one of the symbols,
such that only light in this wave length passes through.
Thereby, the choice of the color decides which one of the two
complementary observables associated with ``pink'' and ``light blue'' is measured.
Propositions refer to the possible ball types drawn from the urn, given the information printed in the chosen color.
\item
initial state identification problem for
deterministic finite (Moore or Mealy)
automata in an unknown initial state~\cite{e-f-moore,svozil-2001-eua};
in particular ones $\left\langle S, I, O, \delta, \lambda \right\rangle$
with four internal states $S=\{1,2,3,4\}$, two input and two output states $I=O=\{0,1\}$,
 an ``irreversible'' (all-to-one) transition function
$\delta (s, i) =1$ for all $s\in S$, $i\in I$,
and an output function  ``modelling'' the state partitions by
$\lambda (1,0)=\lambda (2,0) =0$,
$\lambda (3,0)=\lambda (4,0) =1$,
$\lambda (1,1)=\lambda (3,1) =0$,
$\lambda (2,1)=\lambda (4,1) =1$.
Thereby, the choice of the input symbol decides which one of the two
complementary observables is measured.
\end{enumerate}

Let us, for the moment, consider generalized urn models,
because they allow a ``pleasant'' representation as chocolate balls coated in black foils and
painted with color symbols.
With the four types of chocolate balls
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(8,8) \put(4,2){\circle*{8}} \put(4,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 0}}{\color{Turquoise1} {\bf 0}}$}} \end{picture},
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(8,8) \put(4,2){\circle*{8}} \put(4,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 0}}{\color{Turquoise1} {\bf 1}}$}} \end{picture},
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(8,8) \put(4,2){\circle*{8}} \put(4,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 1}}{\color{Turquoise1} {\bf 0}}$}} \end{picture}, and
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(8,8) \put(4,2){\circle*{8}} \put(4,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 1}}{\color{Turquoise1} {\bf 1}}$}} \end{picture}
drawn from an urn it is
possible to execute the 1984 Bennett-Brassard (BB84) protocol~\cite{benn-84,benn-92}
and ``generate'' a secret key shared by two parties~\cite{svozil-2005-ln1e}.
Formally, this reflects
(i) the random draw of balls from an urn, as well as
(ii) the complementarity modeled
{\em via} the color painting and the colored eyeglasses.
It also reflects the possibility to embed this model into a bigger Boolean (and thus classical)
algebra $2^4$ by ``taking off the eyeglasses'' and looking at both symbols of those four balls types
simultaneously.
The atoms of this Boolean algebra are just the ball types, associated with the four  cases
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(8,8) \put(4,2){\circle*{8}} \put(4,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 0}}{\color{Turquoise1} {\bf 0}}$}} \end{picture},
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(8,8) \put(4,2){\circle*{8}} \put(4,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 0}}{\color{Turquoise1} {\bf 1}}$}} \end{picture},
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(8,8) \put(4,2){\circle*{8}} \put(4,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 1}}{\color{Turquoise1} {\bf 0}}$}} \end{picture}, and
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(8,8) \put(4,2){\circle*{8}} \put(4,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 1}}{\color{Turquoise1} {\bf 1}}$}} \end{picture}.
The possibility of a classical embedding is also reflected in a ``sufficient'' number
(i.e., by a separating, full set) of two-valued, dispersionless (only the sharp values ``$0$'' and ``$1$'' are allowed) states
$P(a_1)+P(a_2)=P(b_1)+P(b_2)=1$, with $P(x)\in \{0,1\}$.
These two-valued states can also be interpreted as logical truth assignments,
irrespective of whether the observables have been (co-)measured.

When comparing BB84-type cryptography with quanta and chocolate balls, one has to keep in mind
that the similarities with respect to complementarity appear somewhat superficial with regards to the state of the objects communicated  {\em after} any measurement.
Because even if an eavesdropper, say Eve, sticks to the rules of the game by putting on colored eyeglasses,
any of her measurements would not affect or change the type of ball, and thus would not cause any {\em disturbance}  of the objects communicated,
thereby not causing any measurement errors between Alice and Bob.
This is different from quantum complementarity and quantum cryptography protected by it,
for if Eve would choose a different observable than Bob she would inevitably alter the state transferred.
This amounts to a disturbance which makes it possible for Alice and Bob to recognize Eve's cryptanalytic attack through occasional measurement errors;
at least if Eve is incapable of controlling the classical channel between the two.
Of course one could alleviate this deficiency of the quasi-classical analogue by requiring Eve not to communicate the original object received from Bob,
but by redrawing from the urn and
sending Alice another object consistent with Eve's measurement.


The possibility to ascribe certain ``ontic states'' interpretable as observer-independent
``omniscient elements of physical reality''
(in the sense of Einstein, Podolsky and Rosen~\cite[p.~777]{epr},
a paper which amazingly contains not a single reference) even for complementarity observables
may raise some skepticism or even outright rejection,
since that is not how quantum mechanics is known to perform at its most mind-boggling mode.
Indeed, so far, the rant presented merely attempted to convince the reader that one can
have complementarity {\em as well as} value definiteness; i.e.,
complementarity is not sufficient for value indefiniteness in the
sense of the Bell- and Kochen-Specker argument.

Unfortunately, the two-dimensionality of the associated Hilbert space
is also a feature
plaguing present random number generators based on beam
splitters~\cite{svozil-qct,rarity-94,zeilinger:qct,stefanov-2000}.
In this respect, most of the present random number generators using
beam splitters are protected by the randomness
of single outcomes as well as by complementarity, but not by
certified value indefiniteness~\cite{PhysRevLett.85.3313,2008-cal-svo,svozil-2009-howto,10.1038/nature09008},
as guaranteed by quantum theory in its standard form~\cite{v-neumann-49}.
%(Yet they may still be certified to pass all {\em diehard} tests by the Swiss Federal Office of Metrology).
Their methodology should also be improved by the methods discussed below.



\section{Supporting cryptography with value indefiniteness}

Fortunately, quantum mechanics is more resourceful and mind-boggling than that,
as it does not permit any two-valued states which may be ontologically  interpretable
as elements of physical reality.
So we have to go further, reminding ourselves that value indefiniteness
comes about only for Hilbert spaces of dimensions three and higher.
There are several ways of doing this.
The following options will be discussed:
\begin{enumerate}
\item
the known protocols can be generalized to three or more outcomes~\cite{PhysRevLett.85.3313};
\item
entangled pairs of particles~\cite{ekert91} associated with statistical value indefiniteness may be considered;
\item
full, nonprobabilistic value indefiniteness may be attempted, at least counterfactually.
\end{enumerate}


\subsection{Generalizations to three and more outcomes}

In constructing quantum random number generators {\em via} beam splitters
which ultimately are used in cryptographic setups, it is important
(i)  to have full control of the particle source, and
(ii) to use beam splitters with three or more output ports,
associated with three- or higher-dimensional Hilbert spaces.
Thereby, the question of whether it is {\em sufficient} for this purpose to compose a multiport beam splitter
by a succession of phase shifters and beam splitters
with two output ports~\cite{rzbb,svozil-2004-analog},
based on elementary decompositions of the unitary group~\cite{murnaghan} remains to be answered.

Dichotomic sequences could be obtained from sequences containing more than two symbols
by discarding all other symbols from that sequence~\cite{MR997340},
or by identifying the additional symbols with one (or both) of the two symbols.
For standard normalization procedures and their issues,
the reader is referred to Refs.~\cite{von-neumann1,Samuelson-1968,elias-72,PeresY-1992,dichtl-2007,Lacharme-2008}.
%http://www.robertnz.net/hwrng.htm

One concrete realization would be a spin-$\frac{3}{2}$ particle. Suppose it is prepared
in one of its four spin states, say the one associated with angular momentum $+\frac{3}{2}\hbar$ in
some arbitrary but definite direction; e.g., by a Stern-Gerlach device.
Then, its  spin state is  again measured along a perpendicular direction;
e.g., by another, differently oriented, Stern-Gerlach device.
Two of the output ports, say the ones corresponding to positive angular momentum $+\frac{3}{2}\hbar$
and $+\frac{1}{2}\hbar$,
are identified with the symbol ``$0$,'' the other two ports with the symbol ``$1$.''
In that way, a random sequence is obtained from quantum coin tosses
which can be ensured to operate under the conditions of value indefiniteness
in the sense of the Kochen-Specker theorem.
Of course, this protocol can also be used to generate random sequences
containing four symbols (one symbol per detector).

With respect to the use of beam splitters, the reader is kindly reminded of another
issue related to the fact that beam splitters are {\em reversible} devices capable of only
translating an incoming  signal into an outgoing  signal in a {\em one-to-one} manner.
The ``nondestructive'' action of a beam splitter could also be demonstrated
by ``reconstructing'' the original signal through a ``reversed'' identical beam splitter
in a Mach-Zehnder interferometer~\cite{green-horn-zei}.
In this sense, the signal leaving the output ports of a beam splitter
is ``as good'' for cryptographic purposes as the one entering the device.
This fact relegates considerations of the quality of quantum randomness
to the quality of the source. Every care should thus be taken in preparing the source
to  assure that the state entering the input port
(i)  either is pure and could subsequently be used for measurements corresponding to conjugate bases,
(ii) or is maximally mixed, resulting in a representation of its
state in finite dimensions proportional to the unit matrix.

\subsection{Configurations with statistical value indefiniteness}

Protocols like the Ekert protocol \cite{ekert91}
utilize two entangled two-state particles for a generation of
a random key shared by two parties. The particular Einstein-Podolsky-Rosen
configuration~\cite{epr} and the singlet Bell state communicated among the
parties guarantee  stronger-than-classical correlations of their sequences,
resulting in a violation of Bell-type inequalities obeyed by classical probabilities.

Although criticized~\cite{PhysRevLett.68.557} on the grounds that the Ekert protocol
in certain cryptanalytic aspects is equivalent to existing ones
(see Ref.~\cite{benn-92b} for a reconciliation),
it offers additional security in the light of quantum value indefiniteness,
as it suggests to probe the nonclassical parts of quantum statistics.
This can best be understood in terms of the impossibility to generate
co-existing tables of all -- even the counterfactually possible -- measurement outcomes
of the quantum observables used~\cite{peres222}.
This, of course, can only happen for the four-dimensional Hilbert space configuration
proposed by Ekert,
and not for effectively two-dimensional ones of previous proposals.
As a result, if the Ekert protocol would be executed with chocolate balls instead of suitable quanta,
the data would not violate the classical bounds predicted by quantum theory, thereby dissatisfying essential criteria thereof.
In this respect the Ekert protocol fails for chocolate balls, thereby indicating potential cryptanalytic risks.
Formally, this is due to the nonexistence of two-valued states
in four-dimensional Hilbert space.

Suppose one would nevertheless attempt to ``mimic'' an Ekert type protocol
proposed by Bennett, Brassard and Mermin (BBM92)~\cite{PhysRevLett.68.557}
with a classical ``singlet'' state
which uses compositions of two balls of the form
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(8,8) \put(4,2){\circle*{8}} \put(4,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 0}}{\color{Turquoise1} {\bf 0}}$}} \end{picture}---\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(8,8) \put(4,2){\circle*{8}} \put(4,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 1}}{\color{Turquoise1} {\bf 1}}$}} \end{picture} / \unitlength 0.7mm \allinethickness{1pt}\begin{picture}(8,8) \put(4,2){\circle*{8}} \put(4,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 0}}{\color{Turquoise1} {\bf 1}}$}} \end{picture}---\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(8,8) \put(4,2){\circle*{8}} \put(4,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 1}}{\color{Turquoise1} {\bf 0}}$}} \end{picture} / \unitlength 0.7mm \allinethickness{1pt}\begin{picture}(8,8) \put(4,2){\circle*{8}} \put(4,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 1}}{\color{Turquoise1} {\bf 0}}$}} \end{picture}---\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(8,8) \put(4,2){\circle*{8}} \put(4
,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 0}}{\color{Turquoise1} {\bf 1}}$}} \end{picture} / \unitlength 0.7mm \allinethickness{1pt}\begin{picture}(8,8) \put(4,2){\circle*{8}} \put(4,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 1}}{\color{Turquoise1} {\bf 1}}$}} \end{picture}---\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(8,8) \put(4,2){\circle*{8}} \put(4,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 0}}{\color{Turquoise1} {\bf 0}}$}} \end{picture},
with strictly different (alternatively strictly identical) particle types.
The resulting probabilities and expectations would obey the classical Clauser-Horne-Shimony-Holt bounds~\cite{chsh}.
This is due to the fact that generalized urn models have quasi-classical probability distributions
which can be represented as convex combinations of the full set of separable two-valued states on their observables.

\subsection{Nonprobabilistic value indefiniteness}

In an attempt to fully utilize quantum value indefiniteness,
we propose a generalization of the BB84 protocol on a propositional structure which does not
allow any two-valued state.
In principle, this could be any kind of finite configuration of observables in three- and higher-dimensional Hilbert space;
in particular ones which have been proposed
for a proof of the Kochen-Specker theorem.
\begin{figure}
\begin{center}
%TeXCAD Picture [4.pic]. Options:
%\grade{\on}
%\emlines{\off}
%\epic{\off}
%\beziermacro{\on}
%\reduce{\on}
%\snapping{\off}
%\quality{8.00}
%\graddiff{0.01}
%\snapasp{1}
%\zoom{5.6569}
\unitlength 1mm % = 2.85pt
\allinethickness{3pt}%\linethickness{0.8pt}
\ifx\plotpoint\undefined\newsavebox{\plotpoint}\fi % GNUPLOT compatibility
\begin{picture}(134.09,125.99)(0,0)
\put(29.168,27.577){{\color{DarkSeaGreen3}\line(1,0){64.169}}}
%\emline(69.826,15.379)(102.53,73.539)
\multiput(69.826,15.379)(.04816494845,.08565537555){679}{{\color{AntiqueWhite3}\line(0,1){.08565537555}}}
%\end
%\emline(102.353,43.487)(69.649,101.999)
\multiput(102.353,43.487)(-.04816494845,.08617378498){679}{{\color{green}\line(0,1){.08617378498}} }
%\end
\put(93.691,89.272){{\color{Snow4}\line(-1,0){64.7}}}
%\emline(53.033,101.823)(20.329,43.487)
\multiput(53.033,101.823)(-.04816494845,-.08591458027){679}{{\color{Purple3}\line(0,-1){.08591458027}}}
%\end
%\emline(20.152,73.539)(53.033,15.203)
\multiput(20.152,73.539)(.0481420205,-.0854114202){683}{{\color{Red4}\line(0,-1){.0854114202}}}
%\end
%\emline(36.592,101.646)(86.09,15.379)
\multiput(36.592,101.646)(.04819668939,-.08399902629){1027}{{\color{LightCyan2}\line(0,-1){.08399902629}}}
%\end
\put(111.015,58.513){{\color{LightSkyBlue2}\line(-1,0){99.348}}}
%\emline(36.416,15.026)(86.266,101.823)
\multiput(36.416,15.026)(.04816425121,.08386183575){1035}{{\color{MediumPurple2}\line(0,1){.08386183575}}}
%\end


\multiput(86.39,14.96)(.119617225,.208133971){209}{{\color{lime}\line(0,1){.208133971}}}
\multiput(86.39,101.96)(.119617225,-.208133971){209}{{\color{olive}\line(0,-1){.208133971}}}
\put(86.39,101.71){{\color{violet}\line(-1,0){50}}}
\multiput(36.47,101.96)(-.119617225,-.208133971){209}{{\color{Turquoise1}\line(0,-1){.208133971}}}
\multiput(36.47,14.96)(-.119617225,.208133971){209}{{\color{yellow}\line(0,1){.208133971}}}
\put(86.39,15.21){{\color{brown}\line(-1,0){50}}}


{\color{DodgerBlue4}\qbezier(52.856,15.203)(56.568,22.009)(44.724,28.461)}{\color{DodgerBlue4}\qbezier(29.345,27.93)(34.029,34.736)(44.724,28.461)}{\color{PaleGreen2}\qbezier(28.991,89.448)(25.279,95.37)(36.416,101.646)}{\color{PaleGreen2}\qbezier(29.345,89.095)(34.029,82.289)(44.724,88.564)}{\color{PaleGreen2}\qbezier(52.856,101.823)(56.568,95.017)(44.724,88.564)}{\color{PaleGreen2}\qbezier(36.416,101.646)(49.055,108.628)(52.856,101.823)}{\color{PaleVioletRed4}\qbezier(69.826,101.646)(73.273,108.452)(86.266,101.469)}{\color{PaleVioletRed4}\qbezier(86.266,101.469)(96.873,95.812)(93.337,89.448)}{\color{PaleVioletRed4}\qbezier(93.337,89.448)(89.713,83.084)(77.958,88.741)}{\color{PaleVioletRed4}\qbezier(77.958,88.741)(66.114,94.663)(69.826,101.646)}{\color{NavajoWhite2}\qbezier(86.266,15.556)(96.873,21.213)(93.337,27.577)}{\color{NavajoWhite2}\qbezier(77.958,28.284)(66.114,22.362)(69.826,15.379)}{\color{NavajoWhite2}\qbezier(93.337,27.577)(89.713,33.941)(77.958,28.284)}{\color{NavajoWhite2}\qbezier(69.826,15.379)
(73.273,8.574)(86.266,15.556)}{\color{Gold2}\qbezier(20.152,73.185)(11.756,73.097)(11.49,58.513)}{\color{Gold2}\qbezier(28.461,58.159)(28.372,73.273)(20.152,73.185)}{\color{Gold2}\qbezier(11.49,58.513)(11.314,43.398)(20.329,43.487)}{\color{Gold2}\qbezier(20.329,43.487)(28.638,43.575)(28.461,58.159)}{\color{Plum2}\qbezier(111.192,58.513)(111.368,43.398)(102.353,43.487)}{\color{Plum2}\qbezier(102.353,43.487)(94.044,43.575)(94.221,58.159)}{\color{Plum2}\qbezier(94.221,58.159)(94.31,73.273)(102.53,73.185)}{\color{Plum2}\qbezier(102.53,73.185)(110.926,73.097)(111.192,58.513)}{\color{blue}\qbezier(29.2,27.73)(23.55,-5.86)(52.99,15.24)}{\color{blue}\qbezier(29.2,27.88)(36.93,75)(69.63,101.91)}{\color{blue}\qbezier(52.69,15.24)(87.47,40.96)(93.72,89.27)}{\color{blue}\qbezier(93.72,89.27)(98.4,125.99)(69.49,102.06)}{\color{DeepPink1}\qbezier(20.15,73.72)(-11.67,58.52)(20.15,43.31)}{\color{DeepPink1}\qbezier(20.33,73.72)(61.34,93.16)(102.36,73.72)}{\color{DeepPink1}\qbezier(102.36,73.72)(134.09,58.52)
(102.53,43.31)}{\color{DeepPink1}\qbezier(102.53,43.31)(60.99,23.43)(20.15,43.49)}{\color{orange}\qbezier(93.57,27.73)(99.22,-5.86)(69.78,15.24)}{\color{orange}\qbezier(93.57,27.88)(85.84,75)(53.13,101.91)}{\color{orange}\qbezier(70.08,15.24)(35.3,40.96)(29.05,89.27)}{\color{orange}\qbezier(29.05,89.27)(24.37,125.99)(53.28,102.06)}{\color{DodgerBlue4}\qbezier(28.991,27.577)(25.279,21.655)(36.416,15.379)}{\color{DodgerBlue4}\qbezier(36.416,15.379)(49.055,8.397)(52.856,15.203)}


\put(11.56,58.45){{\color{Turquoise1}\circle{4}}}
\put(11.56,58.45){{\color{yellow}\circle{6}}}
\put(11.56,58.45){{\color{Gold2}\circle{8}}}
\put(11.56,58.45){{\color{LightSkyBlue2}\circle{2}}}
\put(11.56,58.45){{\color{LightSkyBlue2}\circle{0.1}}}

\put(20.4,73.47){{\color{Turquoise1}\circle{4}}}
\put(20.4,73.47){{\color{DeepPink1}\circle{6}}}
\put(20.4,73.47){{\color{Red4}\circle{8}}}
\put(20.4,73.47){{\color{Gold2}\circle{2}}}
\put(20.4,73.47){{\color{Gold2}\circle{0.1}}}

\put(20.4,43.44){{\color{yellow}\circle{4}}}
\put(20.4,43.44){{\color{DeepPink1}\circle{6}}}
\put(20.4,43.44){{\color{Gold2}\circle{8}}}
\put(20.4,43.44){{\color{Purple3}\circle{2}}}
\put(20.4,43.44){{\color{Purple3}\circle{0.1}}}

\put(28.656,58.45){{\color{Purple3}\circle{4}}}
\put(28.656,58.45){{\color{LightSkyBlue2}\circle{8}}}
\put(28.656,58.45){{\color{Gold2}\circle{6}}}
\put(28.656,58.45){{\color{Red4}\circle{2}}}
\put(28.656,58.45){{\color{Red4}\circle{0.1}}}

\put(94.063,58.45){{\color{LightSkyBlue2}\circle{8}}}
\put(94.063,58.45){{\color{green}\circle{6}}}
\put(94.063,58.45){{\color{AntiqueWhite3}\circle{4}}}
\put(94.063,58.45){{\color{Plum2}\circle{2}}}
\put(94.063,58.45){{\color{Plum2}\circle{0.1}}}


\put(111.21,58.45){{\color{Plum2}\circle{8}}}
\put(111.21,58.45){{\color{olive}\circle{6}}}
\put(111.21,58.45){{\color{lime}\circle{4}}}
\put(111.21,58.45){{\color{LightSkyBlue2}\circle{2}}}
\put(111.21,58.45){{\color{LightSkyBlue2}\circle{0.1}}}


\put(102.37,73.47){{\color{olive}\circle{4}}}
\put(102.37,73.47){{\color{Plum2}\circle{6}}}
\put(102.37,73.47){{\color{DeepPink1}\circle{8}}}
\put(102.37,73.47){{\color{AntiqueWhite3}\circle{2}}}
\put(102.37,73.47){{\color{AntiqueWhite3}\circle{0.1}}}

\put(102.37,43.44){{\color{DeepPink1}\circle{6}}}
\put(102.37,43.44){{\color{lime}\circle{8}}}
\put(102.37,43.44){{\color{Plum2}\circle{4}}}
\put(102.37,43.44){{\color{green}\circle{2}}}
\put(102.37,43.44){{\color{green}\circle{0.1}}}

\put(36.34,15.16){{\color{brown}\circle{4}}}
\put(36.34,15.16){{\color{yellow}\circle{6}}}
\put(36.34,15.16){{\color{MediumPurple2}\circle{8}}}
\put(36.34,15.16){{\color{DodgerBlue4}\circle{2}}}
\put(36.34,15.16){{\color{DodgerBlue4}\circle{0.1}}}

\put(44.919,27.71){{\color{MediumPurple2}\circle{6}}}
\put(44.919,27.71){{\color{DodgerBlue4}\circle{8}}}
\put(44.919,27.71){{\color{DarkSeaGreen3}\circle{4}}}
\put(44.919,27.71){{\color{Red4}\circle{2}}}
\put(44.919,27.71){{\color{Red4}\circle{0.1}}}

\put(29.24,27.71){{\color{yellow}\circle{6}}}
\put(29.24,27.71){{\color{blue}\circle{4}}}
\put(29.24,27.71){{\color{DodgerBlue4}\circle{8}}}
\put(29.24,27.71){{\color{DarkSeaGreen3}\circle{2}}}
\put(29.24,27.71){{\color{DarkSeaGreen3}\circle{0.1}}}

\put(77.976,27.71){{\color{DarkSeaGreen3}\circle{8}}}
\put(77.976,27.71){{\color{LightCyan2}\circle{6}}}
\put(77.976,27.71){{\color{NavajoWhite2}\circle{4}}}
\put(77.976,27.71){{\color{AntiqueWhite3}\circle{2}}}
\put(77.976,27.71){{\color{AntiqueWhite3}\circle{0.1}}}

\put(93.53,27.71){{\color{orange}\circle{6}}}
\put(93.53,27.71){{\color{lime}\circle{4}}}
\put(93.53,27.71){{\color{NavajoWhite2}\circle{8}}}
\put(93.53,27.71){{\color{DarkSeaGreen3}\circle{2}}}
\put(93.53,27.71){{\color{DarkSeaGreen3}\circle{0.1}}}

\put(86.28,15.16){{\color{lime}\circle{6}}}
\put(86.28,15.16){{\color{brown}\circle{4}}}
\put(86.28,15.16){{\color{LightCyan2}\circle{8}}}
\put(86.28,15.16){{\color{NavajoWhite2}\circle{2}}}
\put(86.28,15.16){{\color{NavajoWhite2}\circle{0.1}}}

\put(52.99,15.16){{\color{brown}\circle{4}}}
\put(52.99,15.16){{\color{blue}\circle{6}}}
\put(52.99,15.16){{\color{Red4}\circle{8}}}
\put(52.99,15.16){{\color{DodgerBlue4}\circle{2}}}
\put(52.99,15.16){{\color{DodgerBlue4}\circle{0.1}}}

\put(69.68,15.16){{\color{brown}\circle{4}}}
\put(69.68,15.16){{\color{orange}\circle{6}}}
\put(69.68,15.16){{\color{AntiqueWhite3}\circle{8}}}
\put(69.68,15.16){{\color{NavajoWhite2}\circle{2}}}
\put(69.68,15.16){{\color{NavajoWhite2}\circle{0.1}}}

\put(93.53,89.21){{\color{olive}\circle{4}}}
\put(93.53,89.21){{\color{blue}\circle{6}}}
\put(93.53,89.21){{\color{PaleVioletRed4}\circle{8}}}
\put(93.53,89.21){{\color{Snow4}\circle{2}}}
\put(93.53,89.21){{\color{Snow4}\circle{0.1}}}

\put(77.976,88.679){{\color{Snow4}\circle{8}}}
\put(77.976,88.679){{\color{PaleVioletRed4}\circle{6}}}
\put(77.976,88.679){{\color{green}\circle{4}}}
\put(77.976,88.679){{\color{MediumPurple2}\circle{2}}}
\put(77.976,88.679){{\color{MediumPurple2}\circle{0.1}}}

\put(86.28,101.76){{\color{violet}\circle{8}}}
\put(86.28,101.76){{\color{MediumPurple2}\circle{6}}}
\put(86.28,101.76){{\color{olive}\circle{4}}}
\put(86.28,101.76){{\color{PaleVioletRed4}\circle{2}}}
\put(86.28,101.76){{\color{PaleVioletRed4}\circle{0.1}}}

\put(69.68,101.76){{\color{PaleVioletRed4}\circle{8}}}
\put(69.68,101.76){{\color{blue}\circle{6}}}
\put(69.68,101.76){{\color{violet}\circle{4}}}
\put(69.68,101.76){{\color{green}\circle{2}}}
\put(69.68,101.76){{\color{green}\circle{0.1}}}

\put(52.99,101.76){{\color{violet}\circle{8}}}
\put(52.99,101.76){{\color{PaleGreen2}\circle{6}}}
\put(52.99,101.76){{\color{orange}\circle{4}}}
\put(52.99,101.76){{\color{Purple3}\circle{2}}}
\put(52.99,101.76){{\color{Purple3}\circle{0.1}}}

\put(36.34,101.76){{\color{PaleGreen2}\circle{8}}}
\put(36.34,101.76){{\color{Turquoise1}\circle{6}}}
\put(36.34,101.76){{\color{violet}\circle{4}}}
\put(36.34,101.76){{\color{LightCyan2}\circle{2}}}
\put(36.34,101.76){{\color{LightCyan2}\circle{0.1}}}

\put(44.743,88.679){{\color{LightCyan2}\circle{8}}}
\put(44.743,88.679){{\color{PaleGreen2}\circle{6}}}
\put(44.743,88.679){{\color{Snow4}\circle{4}}}
\put(44.743,88.679){{\color{Purple3}\circle{2}}}
\put(44.743,88.679){{\color{Purple3}\circle{0.1}}}

\put(29.24,89.21){{\color{PaleGreen2}\circle{8}}}
\put(29.24,89.21){{\color{orange}\circle{6}}}
\put(29.24,89.21){{\color{Turquoise1}\circle{4}}}
\put(29.24,89.21){{\color{Snow4}\circle{2}}}
\put(29.24,89.21){{\color{Snow4}\circle{0.1}}}




{\color{black} \normalsize
\put(34,116.02){\makebox(0,0)[rc]{$(0,1,-1,0)$}}
\put(34,2.65){\makebox(0,0)[rc]{$(0,0,1,-1)$}}
\put(63,116.38){\makebox(0,0)[rc]{$(1,0,0,1)$}}
\put(63,2.3){\makebox(0,0)[rc]{$(1,-1,0,0)$}}
\put(100,116.2){\makebox(0,0)[lc]{$(-1,1,1,1)$}}
\put(100,2.48){\makebox(0,0)[lc]{$(1,1,1,1)$}}
\put(65.65,116.38){\makebox(0,0)[lc]{$(1,1,1,-1)$}}
\put(65.65,2.3){\makebox(0,0)[lc]{$(1,1,-1,-1)$}}
\put(108.24,94.22){\makebox(0,0)[lc]{$(1,1,-1,1)$}}
\put(17.45,94.22){\makebox(0,0)[rc]{$(0,1,1,0)$}}
\put(108.24,22.45){\makebox(0,0)[lc]{$(1,-1,1,-1)$}}
\put(16.45,22.45){\makebox(0,0)[rc]{$(0,0,1,1)$}}
\put(114.13,77.96){\makebox(0,0)[lc]{$(1,0,1,0)$}}
\put(8.55,77.96){\makebox(0,0)[rc]{$(0,0,0,1)$}}
\put(114.13,38.72){\makebox(0,0)[lc]{$(1,0,-1,0)$}}
\put(8.55,38.72){\makebox(0,0)[rc]{$(0,1,0,0)$}}
\put(120.92,57.98){\makebox(0,0)[lc]{$(0,1,0,-1)$}}
\put(1.77,57.98){\makebox(0,0)[rc]{$(1,0,0,0)$}}
}
\end{picture}
\end{center}
\caption{ \label{2009-QvPR}
(Color online)
Greechie orthogonality diagram of a ``short'' proof~\cite{cabello-96,cabello:210401} of the Kochen-Specker theorem
in four dimensions containing 24 vectors whose linear span can be identified with propositions~\cite{birkhoff-36} in 24 tightly interlinked contexts~\cite{tkadlec-priv}.
The graph cannot be colored by the two colors red (associated with truth)
and green (associated with falsity) such that every context contains exactly one red and three green points.
For the sake of a proof, consider just the six outer lines and the three outer ellipses.
Indeed,  in a table containing the points of the contexts as columns
and the enumeration of contexts as rows,
every red point occurs in exactly {\em four} contexts, and
there should be an {\em even} number of red points.
On the other hand, there are 15 contexts involved; thus by the rules it follows that there
should be an {\em odd} number (15) of red points in this table (exactly one per context).
}
\end{figure}


\begin{figure}
\begin{center}
\begin{tabular}{cccccc}
%TeXCAD Picture [1.pic]. Options:
%\grade{\on}
%\emlines{\off}
%\epic{\off}
%\beziermacro{\on}
%\reduce{\on}
%\snapping{\off}
%\pvinsert{% Your \input, \def, etc. here}
%\quality{8.000}
%\graddiff{0.005}
%\snapasp{1}
%\zoom{4.0000}
\unitlength 0.5mm % = 2.85pt
\allinethickness{3pt}%\linethickness{0.8pt}
\ifx\plotpoint\undefined\newsavebox{\plotpoint}\fi % GNUPLOT compatibility
\begin{picture}(132.5,122)(0,0)
\put(20,20){\color{Turquoise1}\line(1,0){110}}
%\emline(20,20)(75,110)
\multiput(20,20)(.03372164316,.05518087063){1631}{\color{yellow}\line(0,1){.05518087063}}
%\end
%\emline(75,110)(130,20)
\multiput(75,110)(.03372164316,-.05518087063){1631}{\color{DeepPink1}\line(0,-1){.05518087063}}
%\end
\put(20,20){\color{Turquoise1}\circle{9}}
\put(20,20){\color{yellow}\circle{5.5}}
\put(20,20){\color{yellow}\circle{1.5}}
\put(56.25,20){\color{Turquoise1}\circle{5.5}}
\put(56.25,20){\color{Turquoise1}\circle{1.5}}
\put(92.5,20){\color{Turquoise1}\circle{5.5}}
\put(92.5,20){\color{Turquoise1}\circle{1.5}}
\put(129.75,20){\color{DeepPink1}\circle{9}}
\put(129.75,20){\color{Turquoise1}\circle{5.5}}
\put(129.75,20){\color{Turquoise1}\circle{1.5}}
\put(56.25,79.75){\color{yellow}\circle{5.5}}
\put(56.25,79.75){\color{yellow}\circle{1.5}}
\put(38.75,51.25){\color{yellow}\circle{5.5}}
\put(38.75,51.25){\color{yellow}\circle{1.5}}
\put(74.75,109.75){\color{yellow}\circle{9}}
\put(74.75,109.75){\color{DeepPink1}\circle{5.5}}
\put(74.75,109.75){\color{DeepPink1}\circle{1.5}}
\put(93.75,79.75){\color{DeepPink1}\circle{5.5}}
\put(93.75,79.75){\color{DeepPink1}\circle{1.5}}
\put(111.25,51.25){\color{DeepPink1}\circle{5.5}}
\put(111.25,51.25){\color{DeepPink1}\circle{1.5}}
\put(15,5){\makebox(0,0)[cc]{$(1,0,0,0)$}}
\put(52,5){\makebox(0,0)[cc]{$(0,1,1,0)$}}
\put(92.5,5){\makebox(0,0)[cc]{$(0,1,-1,0)$}}
\put(138,5){\makebox(0,0)[cc]{$(0,0,0,1)$}}
\put(74.75,122){\makebox(0,0)[cc]{$(0,1,0,0)$}}
\put(108,80.25){\makebox(0,0)[lc]{$(1,0,-1,0)$}}
\put(125,52.25){\makebox(0,0)[lc]{$(1,0,1,0)$}}
\put(42.5,80.25){\makebox(0,0)[rc]{$(0,0,1,-1)$}}
\put(25.5,52.25){\makebox(0,0)[rc]{$(0,0,1,1)$}}
\end{picture}
&
\qquad
\qquad
\qquad
\qquad
&

%TeXCAD Picture [1.pic]. Options:
%\grade{\on}
%\emlines{\off}
%\epic{\off}
%\beziermacro{\on}
%\reduce{\on}
%\snapping{\off}
%\pvinsert{% Your \input, \def, etc. here}
%\quality{8.000}
%\graddiff{0.005}
%\snapasp{1}
%\zoom{4.0000}
\unitlength 0.5mm % = 2.85pt
\allinethickness{3pt}%\linethickness{0.8pt}
\ifx\plotpoint\undefined\newsavebox{\plotpoint}\fi % GNUPLOT compatibility
\begin{picture}(132.5,122)(0,0)
\put(20,20){\color{Turquoise1}\line(1,0){73}}
%\emline(20,20)(75,110)
%\multiput(20,20)(.03372164316,.05518087063){1631}{\color{yellow}\line(0,1){.05518087063}}
\multiput(20,20)(.03372164316,.05518087063){1080}{\color{DeepPink1}\line(0,1){.05518087063}}
%\end
\put(20,20){\color{Turquoise1}\circle{9}}
\put(20,20){\color{DeepPink1}\circle{5.5}}
\put(20,20){\color{DeepPink1}\circle{1.5}}
\put(56.25,20){\color{Turquoise1}\circle{5.5}}
\put(56.25,20){\color{Turquoise1}\circle{1.5}}
\put(92.5,20){\color{Turquoise1}\circle{5.5}}
\put(92.5,20){\color{Turquoise1}\circle{1.5}}
\put(56.25,79.75){\color{DeepPink1}\circle{5.5}}
\put(56.25,79.75){\color{DeepPink1}\circle{1.5}}
\put(38.75,51.25){\color{DeepPink1}\circle{5.5}}
\put(38.75,51.25){\color{DeepPink1}\circle{1.5}}
\put(15,5){\makebox(0,0)[cc]{$(1,0,0)$}}
\put(52,5){\makebox(0,0)[cc]{$(0,1,1)$}}
\put(92.5,5){\makebox(0,0)[cc]{$(0,1,-1)$}}
\put(28,52.25){\makebox(0,0)[rc]{$(0,1,0)$}}
\put(42.5,80.25){\makebox(0,0)[rc]{$(0,0,1)$}}
\end{picture}
\\
(a)&&(b)
\end{tabular}
\end{center}
\caption{ \label{2009-QvPRtria}
(Color online)
Subdiagrams of Figure~\ref{2009-QvPR} allowing (value definite)
chocolate ball realizations.
}
\end{figure}

For the sake of a concrete example, we shall consider a variant of the tightly interlinked collection of observables
in four-dimensional Hilbert space
presented by Cabello, Estebaranz and Garc{\'i}a-Alcaine~\cite{cabello-96,cabello:210401},
which is depicted in Figure~\ref{2009-QvPR}.
(Their original configuration would also suffice for the following argument.)
Instead of two measurement bases of two-dimensional Hilbert space used in the BB84 protocol,
15 such bases of four-dimensional Hilbert space, corresponding to the 15 smooth (unbroken) orthogonal curves
in Fig.~\ref{2009-QvPR} are used.
In what follows, it is assumed that any kind of random decision has been prepared
according to the protocol for generating
random sequences sketched above.


\begin{enumerate}
\item
In the first step, ``Alice'' randomly picks an arbitrary basis from the 15 available ones,
and sends a random state to ``Bob.''
\item
In the second step, Bob independently from Alice, picks some (not necessarily different from Alice's) basis at random,
and measures the particle received from Alice.
\item
In the third step, Alice and Bob compare their bases over a public channel,
and keep only those events which were recorded either in a common basis,
or in an observable interlinking two different bases.
\item
Both then exchange some of the matching outcomes  over a public channel to assure that nobody
has attended their quantum channel.
\item
Bob and Alice encode the four outcomes by four or less different symbols.
As a result, Bob and Alice share a common random key certified by quantum value indefiniteness.
\end{enumerate}


The advantage of this protocol resides in the fact that it does not allow its realization by
any partition of a set, or any kind of colored chocolate balls.
Because if it did, any such coloring could be used to generate ``classical'' two-valued states,
which in turn may be used towards a classical re-interpretation of the quantum observables; an option
ruled out by the Kochen-Specker theorem.

Readers  not  totally convinced at this point might, for the sake of demonstration,
consider a generalized urn model with 15 colors, associated with the 15 bases
in Figure~\ref{2009-QvPR}.
Suppose further that there is a uniform set of symbols, say $\{0,1,2,3\}$
for all four colors.
If all varieties (permutations) contribute, the number of different types of balls
should be $4^9$. Note, however, that every interlinked color must have {\em identical}
symbols in the interlinking colors; a condition which cannot be satisfied
globally for all the interlinks in Figure~\ref{2009-QvPR}.


For the sake of an explicit demonstration, a simplified version of the protocol, which is based on a subdiagram
of Figure~\ref{2009-QvPR}, contains only three contexts,
which are closely interlinked.
The structure of observables is depicted in Figure~\ref{2009-QvPRtria}(a).
The vectors represent observables in four-dimensional Hilbert space
in their usual interpretation as projectors generating the one-dimensional subspaces spanned by them.
In addition to this quantum mechanical
representation, and in contrast to the Kochen-Specker configuration in Figure~\ref{2009-QvPR},
this global collection of observables
still allows for value definiteness, as there are ``enough'' two valued states
permitting the formation of a partition logic and thus a chocolate ball realization; e.g.,
$$
\begin{array}{c}
\{
\{
\{1,2
\},
\{ 3,4,5,6,7
\},
\{ 8,9,10,11,12
\},
\{13,14
\}
\}, \\
\{
\{1,4,5,9,10
\},
\{ 2,6,7,11,12
\},
\{ 3,8
\},
\{ 13,14
\}
\}, \\
\{
\{ 1,2
\},
\{ 3,8
\},
\{ 4,6,9,11,13
\},
\{ 5,7,10,12,14
\}
\}
\}.
\end{array}
$$
The three partitions of the set $\{1,2,\ldots ,14\}$ have been obtained
by indexing the atoms in terms of
all the nonvanishing
two-valued states on them~\cite{svozil-2001-eua,svozil-2008-ql}, as
depicted in Figure~\ref{2009-qcho-f2vs}.
They can be straightforwardly applied for a chocolate
ball configuration with three colors (say green, red and blue)
and four symbols (say 0, 1, 2, and 3).
The 14 ball types corresponding to the 14 different two-valued measures are as follows:
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(12,12)\put(6,2){\circle*{12}} \put(6,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 0}}{\color{Turquoise1} {\bf 0}}{\color{yellow} {\bf 0}}$}}\end{picture},
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(12,12)\put(6,2){\circle*{12}} \put(6,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 0}}{\color{Turquoise1} {\bf 1}}{\color{yellow} {\bf 0}}$}}\end{picture},
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(12,12)\put(6,2){\circle*{12}} \put(6,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 1}}{\color{Turquoise1} {\bf 2}}{\color{yellow} {\bf 1}}$}}\end{picture},
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(12,12)\put(6,2){\circle*{12}} \put(6,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 1}}{\color{Turquoise1} {\bf 0}}{\color{yellow} {\bf 2}}$}}\end{picture},
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(12,12)\put(6,2){\circle*{12}} \put(6,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 1}}{\color{Turquoise1} {\bf 0}}{\color{yellow} {\bf 3}}$}}\end{picture},
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(12,12)\put(6,2){\circle*{12}} \put(6,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 1}}{\color{Turquoise1} {\bf 1}}{\color{yellow} {\bf 2}}$}}\end{picture},
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(12,12)\put(6,2){\circle*{12}} \put(6,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 1}}{\color{Turquoise1} {\bf 1}}{\color{yellow} {\bf 3}}$}}\end{picture},
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(12,12)\put(6,2){\circle*{12}} \put(6,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 2}}{\color{Turquoise1} {\bf 2}}{\color{yellow} {\bf 1}}$}}\end{picture},
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(12,12)\put(6,2){\circle*{12}} \put(6,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 2}}{\color{Turquoise1} {\bf 0}}{\color{yellow} {\bf 2}}$}}\end{picture},
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(12,12)\put(6,2){\circle*{12}} \put(6,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 2}}{\color{Turquoise1} {\bf 0}}{\color{yellow} {\bf 3}}$}}\end{picture},
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(12,12)\put(6,2){\circle*{12}} \put(6,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 2}}{\color{Turquoise1} {\bf 1}}{\color{yellow} {\bf 2}}$}}\end{picture},
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(12,12)\put(6,2){\circle*{12}} \put(6,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 2}}{\color{Turquoise1} {\bf 1}}{\color{yellow} {\bf 3}}$}}\end{picture},
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(12,12)\put(6,2){\circle*{12}} \put(6,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 3}}{\color{Turquoise1} {\bf 3}}{\color{yellow} {\bf 2}}$}}\end{picture}, and
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(12,12)\put(6,2){\circle*{12}} \put(6,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 3}}{\color{Turquoise1} {\bf 3}}{\color{yellow} {\bf 3}}$}}\end{picture}.




Figure~\ref{2009-QvPRtria}(b) contains a three-dimensional subconfiguration
with two complementary contexts interlinked in a single observable.
It again has a value definite representation in terms of partitions of a set,
and thus again a chocolate ball realization with three symbols in two colors; e.g.,
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(8,8) \put(4,2){\circle*{8}} \put(4,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 0}}{\color{Turquoise1} {\bf 0}}$}} \end{picture},
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(8,8) \put(4,2){\circle*{8}} \put(4,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 1}}{\color{Turquoise1} {\bf 1}}$}} \end{picture},
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(8,8) \put(4,2){\circle*{8}} \put(4,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 1}}{\color{Turquoise1} {\bf 2}}$}} \end{picture},
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(8,8) \put(4,2){\circle*{8}} \put(4,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 2}}{\color{Turquoise1} {\bf 1}}$}} \end{picture}, and
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(8,8) \put(4,2){\circle*{8}} \put(4,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 2}}{\color{Turquoise1} {\bf 2}}$}} \end{picture}.

\begin{figure}
\begin{tabular}{cccccccccc}
%TeXCAD Picture [1.pic]. Options:
%\grade{\on}
%\emlines{\off}
%\epic{\off}
%\beziermacro{\on}
%\reduce{\on}
%\snapping{\off}
%\pvinsert{% Your \input, \def, etc. here}
%\quality{8.000}
%\graddiff{0.005}
%\snapasp{1}
%\zoom{4.0000}
\unitlength 0.2mm % = 2.85pt
\allinethickness{1pt}%\linethickness{0.8pt}
\ifx\plotpoint\undefined\newsavebox{\plotpoint}\fi % GNUPLOT compatibility
\begin{picture}(132.5,122)(0,0)
\put(20,20){\line(1,0){110}}
%\emline(20,20)(75,110)
\put(20,20){\line(3,5){55}}
%\end
%\emline(75,110)(130,20)
\put(130,20){\line(-3,5){55}}
%\end
\put(20,20){\circle*{8}} \put(15,5){\makebox(0,0)[cc]{$1$}}            %1
\put(111.25,51.25){\circle*{8}} \put(125,52.25){\makebox(0,0)[lc]{$5$}} %5
\put(74,52){\makebox(0,0)[cc]{\Large \bf 1}} \put(74,52){\circle{40}}
\end{picture}
&
%TeXCAD Picture [1.pic]. Options:
%\grade{\on}
%\emlines{\off}
%\epic{\off}
%\beziermacro{\on}
%\reduce{\on}
%\snapping{\off}
%\pvinsert{% Your \input, \def, etc. here}
%\quality{8.000}
%\graddiff{0.005}
%\snapasp{1}
%\zoom{4.0000}
\unitlength 0.2mm % = 2.85pt
\allinethickness{1pt}%\linethickness{0.8pt}
\ifx\plotpoint\undefined\newsavebox{\plotpoint}\fi % GNUPLOT compatibility
\begin{picture}(132.5,122)(0,0)
\put(20,20){\line(1,0){110}}
%\emline(20,20)(75,110)
\put(20,20){\line(3,5){55}}
%\end
%\emline(75,110)(130,20)
\put(130,20){\line(-3,5){55}}
%\end
\put(20,20){\circle*{8}} \put(15,5){\makebox(0,0)[cc]{$1$}}            %1
\put(93.75,79.75){\circle*{8}} \put(108,80.25){\makebox(0,0)[lc]{$6$}}  %6
\put(74,52){\makebox(0,0)[cc]{\Large \bf 2}} \put(74,52){\circle{40}} \end{picture}
&
%TeXCAD Picture [1.pic]. Options:
%\grade{\on}
%\emlines{\off}
%\epic{\off}
%\beziermacro{\on}
%\reduce{\on}
%\snapping{\off}
%\pvinsert{% Your \input, \def, etc. here}
%\quality{8.000}
%\graddiff{0.005}
%\snapasp{1}
%\zoom{4.0000}
\unitlength 0.2mm % = 2.85pt
\allinethickness{1pt}%\linethickness{0.8pt}
\ifx\plotpoint\undefined\newsavebox{\plotpoint}\fi % GNUPLOT compatibility
\begin{picture}(132.5,122)(0,0)
\put(20,20){\line(1,0){110}}
%\emline(20,20)(75,110)
\put(20,20){\line(3,5){55}}
%\end
%\emline(75,110)(130,20)
\put(130,20){\line(-3,5){55}}
%\end
\put(56.25,20){\circle*{8}}\put(52,5){\makebox(0,0)[cc]{$2$}}         %2
\put(74.75,109.75){\circle*{8}} \put(74.75,122){\makebox(0,0)[cc]{$7$}} %7
\put(74,52){\makebox(0,0)[cc]{\Large \bf 3}} \put(74,52){\circle{40}} \end{picture}
&
%TeXCAD Picture [1.pic]. Options:
%\grade{\on}
%\emlines{\off}
%\epic{\off}
%\beziermacro{\on}
%\reduce{\on}
%\snapping{\off}
%\pvinsert{% Your \input, \def, etc. here}
%\quality{8.000}
%\graddiff{0.005}
%\snapasp{1}
%\zoom{4.0000}
\unitlength 0.2mm % = 2.85pt
\allinethickness{1pt}%\linethickness{0.8pt}
\ifx\plotpoint\undefined\newsavebox{\plotpoint}\fi % GNUPLOT compatibility
\begin{picture}(132.5,122)(0,0)
\put(20,20){\line(1,0){110}}
%\emline(20,20)(75,110)
\put(20,20){\line(3,5){55}}
%\end
%\emline(75,110)(130,20)
\put(130,20){\line(-3,5){55}}
%\end
\put(56.25,20){\circle*{8}}\put(52,5){\makebox(0,0)[cc]{$2$}}         %2
\put(111.25,51.25){\circle*{8}} \put(125,52.25){\makebox(0,0)[lc]{$5$}} %5
\put(56.25,79.75){\circle*{8}} \put(42.5,80.25){\makebox(0,0)[rc]{$8$}}%8
\put(74,52){\makebox(0,0)[cc]{\Large \bf 4}} \put(74,52){\circle{40}} \end{picture}
\\
%TeXCAD Picture [1.pic]. Options:
%\grade{\on}
%\emlines{\off}
%\epic{\off}
%\beziermacro{\on}
%\reduce{\on}
%\snapping{\off}
%\pvinsert{% Your \input, \def, etc. here}
%\quality{8.000}
%\graddiff{0.005}
%\snapasp{1}
%\zoom{4.0000}
\unitlength 0.2mm % = 2.85pt
\allinethickness{1pt}%\linethickness{0.8pt}
\ifx\plotpoint\undefined\newsavebox{\plotpoint}\fi % GNUPLOT compatibility
\begin{picture}(132.5,122)(0,0)
\put(20,20){\line(1,0){110}}
%\emline(20,20)(75,110)
\put(20,20){\line(3,5){55}}
%\end
%\emline(75,110)(130,20)
\put(130,20){\line(-3,5){55}}
%\end
\put(56.25,20){\circle*{8}}\put(52,5){\makebox(0,0)[cc]{$2$}}         %2
\put(111.25,51.25){\circle*{8}} \put(125,52.25){\makebox(0,0)[lc]{$5$}} %5
\put(38.75,51.25){\circle*{8}} \put(25.5,52.25){\makebox(0,0)[rc]{$9$}}%9
\put(74,52){\makebox(0,0)[cc]{\Large \bf 5}} \put(74,52){\circle{40}} \end{picture}
&
%TeXCAD Picture [1.pic]. Options:
%\grade{\on}
%\emlines{\off}
%\epic{\off}
%\beziermacro{\on}
%\reduce{\on}
%\snapping{\off}
%\pvinsert{% Your \input, \def, etc. here}
%\quality{8.000}
%\graddiff{0.005}
%\snapasp{1}
%\zoom{4.0000}
\unitlength 0.2mm % = 2.85pt
\allinethickness{1pt}%\linethickness{0.8pt}
\ifx\plotpoint\undefined\newsavebox{\plotpoint}\fi % GNUPLOT compatibility
\begin{picture}(132.5,122)(0,0)
\put(20,20){\line(1,0){110}}
%\emline(20,20)(75,110)
\put(20,20){\line(3,5){55}}
%\end
%\emline(75,110)(130,20)
\put(130,20){\line(-3,5){55}}
%\end
\put(56.25,20){\circle*{8}}\put(52,5){\makebox(0,0)[cc]{$2$}}         %2
\put(93.75,79.75){\circle*{8}} \put(108,80.25){\makebox(0,0)[lc]{$6$}}  %6
\put(56.25,79.75){\circle*{8}} \put(42.5,80.25){\makebox(0,0)[rc]{$8$}}%8
\put(74,52){\makebox(0,0)[cc]{\Large \bf 6}} \put(74,52){\circle{40}} \end{picture}
&
%TeXCAD Picture [1.pic]. Options:
%\grade{\on}
%\emlines{\off}
%\epic{\off}
%\beziermacro{\on}
%\reduce{\on}
%\snapping{\off}
%\pvinsert{% Your \input, \def, etc. here}
%\quality{8.000}
%\graddiff{0.005}
%\snapasp{1}
%\zoom{4.0000}
\unitlength 0.2mm % = 2.85pt
\allinethickness{1pt}%\linethickness{0.8pt}
\ifx\plotpoint\undefined\newsavebox{\plotpoint}\fi % GNUPLOT compatibility
\begin{picture}(132.5,122)(0,0)
\put(20,20){\line(1,0){110}}
%\emline(20,20)(75,110)
\put(20,20){\line(3,5){55}}
%\end
%\emline(75,110)(130,20)
\put(130,20){\line(-3,5){55}}
%\end
\put(56.25,20){\circle*{8}}\put(52,5){\makebox(0,0)[cc]{$2$}}         %2
\put(93.75,79.75){\circle*{8}} \put(108,80.25){\makebox(0,0)[lc]{$6$}}  %6
\put(38.75,51.25){\circle*{8}} \put(25.5,52.25){\makebox(0,0)[rc]{$9$}}%9
\put(74,52){\makebox(0,0)[cc]{\Large \bf 7}} \put(74,52){\circle{40}} \end{picture}
&
%TeXCAD Picture [1.pic]. Options:
%\grade{\on}
%\emlines{\off}
%\epic{\off}
%\beziermacro{\on}
%\reduce{\on}
%\snapping{\off}
%\pvinsert{% Your \input, \def, etc. here}
%\quality{8.000}
%\graddiff{0.005}
%\snapasp{1}
%\zoom{4.0000}
\unitlength 0.2mm % = 2.85pt
\allinethickness{1pt}%\linethickness{0.8pt}
\ifx\plotpoint\undefined\newsavebox{\plotpoint}\fi % GNUPLOT compatibility
\begin{picture}(132.5,122)(0,0)
\put(20,20){\line(1,0){110}}
%\emline(20,20)(75,110)
\put(20,20){\line(3,5){55}}
%\end
%\emline(75,110)(130,20)
\put(130,20){\line(-3,5){55}}
%\end
\put(92.5,20){\circle*{8}}\put(92.5,5){\makebox(0,0)[cc]{$3$}}        %3
\put(74.75,109.75){\circle*{8}} \put(74.75,122){\makebox(0,0)[cc]{$7$}} %7
\put(74,52){\makebox(0,0)[cc]{\Large \bf 8}} \put(74,52){\circle{40}} \end{picture}
\\
%TeXCAD Picture [1.pic]. Options:
%\grade{\on}
%\emlines{\off}
%\epic{\off}
%\beziermacro{\on}
%\reduce{\on}
%\snapping{\off}
%\pvinsert{% Your \input, \def, etc. here}
%\quality{8.000}
%\graddiff{0.005}
%\snapasp{1}
%\zoom{4.0000}
\unitlength 0.2mm % = 2.85pt
\allinethickness{1pt}%\linethickness{0.8pt}
\ifx\plotpoint\undefined\newsavebox{\plotpoint}\fi % GNUPLOT compatibility
\begin{picture}(132.5,122)(0,0)
\put(20,20){\line(1,0){110}}
%\emline(20,20)(75,110)
\put(20,20){\line(3,5){55}}
%\end
%\emline(75,110)(130,20)
\put(130,20){\line(-3,5){55}}
%\end
\put(92.5,20){\circle*{8}}\put(92.5,5){\makebox(0,0)[cc]{$3$}}        %3
\put(111.25,51.25){\circle*{8}} \put(125,52.25){\makebox(0,0)[lc]{$5$}} %5
\put(56.25,79.75){\circle*{8}} \put(42.5,80.25){\makebox(0,0)[rc]{$8$}}%8
\put(74,52){\makebox(0,0)[cc]{\Large \bf 9}} \put(74,52){\circle{40}} \end{picture}
&
%TeXCAD Picture [1.pic]. Options:
%\grade{\on}
%\emlines{\off}
%\epic{\off}
%\beziermacro{\on}
%\reduce{\on}
%\snapping{\off}
%\pvinsert{% Your \input, \def, etc. here}
%\quality{8.000}
%\graddiff{0.005}
%\snapasp{1}
%\zoom{4.0000}
\unitlength 0.2mm % = 2.85pt
\allinethickness{1pt}%\linethickness{0.8pt}
\ifx\plotpoint\undefined\newsavebox{\plotpoint}\fi % GNUPLOT compatibility
\begin{picture}(132.5,122)(0,0)
\put(20,20){\line(1,0){110}}
%\emline(20,20)(75,110)
\put(20,20){\line(3,5){55}}
%\end
%\emline(75,110)(130,20)
\put(130,20){\line(-3,5){55}}
%\end
\put(92.5,20){\circle*{8}}\put(92.5,5){\makebox(0,0)[cc]{$3$}}        %3
\put(111.25,51.25){\circle*{8}} \put(125,52.25){\makebox(0,0)[lc]{$5$}} %5
\put(38.75,51.25){\circle*{8}} \put(25.5,52.25){\makebox(0,0)[rc]{$9$}}%9
\put(74,52){\makebox(0,0)[cc]{\Large \bf 10}} \put(74,52){\circle{40}} \end{picture}
&
%TeXCAD Picture [1.pic]. Options:
%\grade{\on}
%\emlines{\off}
%\epic{\off}
%\beziermacro{\on}
%\reduce{\on}
%\snapping{\off}
%\pvinsert{% Your \input, \def, etc. here}
%\quality{8.000}
%\graddiff{0.005}
%\snapasp{1}
%\zoom{4.0000}
\unitlength 0.2mm % = 2.85pt
\allinethickness{1pt}%\linethickness{0.8pt}
\ifx\plotpoint\undefined\newsavebox{\plotpoint}\fi % GNUPLOT compatibility
\begin{picture}(132.5,122)(0,0)
\put(20,20){\line(1,0){110}}
%\emline(20,20)(75,110)
\put(20,20){\line(3,5){55}}
%\end
%\emline(75,110)(130,20)
\put(130,20){\line(-3,5){55}}
%\end
\put(92.5,20){\circle*{8}}\put(92.5,5){\makebox(0,0)[cc]{$3$}}        %3
\put(93.75,79.75){\circle*{8}} \put(108,80.25){\makebox(0,0)[lc]{$6$}}  %6
\put(56.25,79.75){\circle*{8}} \put(42.5,80.25){\makebox(0,0)[rc]{$8$}}%8
\put(74,52){\makebox(0,0)[cc]{\Large \bf 11}} \put(74,52){\circle{40}} \end{picture}
&
%TeXCAD Picture [1.pic]. Options:
%\grade{\on}
%\emlines{\off}
%\epic{\off}
%\beziermacro{\on}
%\reduce{\on}
%\snapping{\off}
%\pvinsert{% Your \input, \def, etc. here}
%\quality{8.000}
%\graddiff{0.005}
%\snapasp{1}
%\zoom{4.0000}
\unitlength 0.2mm % = 2.85pt
\allinethickness{1pt}%\linethickness{0.8pt}
\ifx\plotpoint\undefined\newsavebox{\plotpoint}\fi % GNUPLOT compatibility
\begin{picture}(132.5,122)(0,0)
\put(20,20){\line(1,0){110}}
%\emline(20,20)(75,110)
\put(20,20){\line(3,5){55}}
%\end
%\emline(75,110)(130,20)
\put(130,20){\line(-3,5){55}}
%\end
\put(92.5,20){\circle*{8}}\put(92.5,5){\makebox(0,0)[cc]{$3$}}        %3
\put(93.75,79.75){\circle*{8}} \put(108,80.25){\makebox(0,0)[lc]{$6$}}  %6
\put(38.75,51.25){\circle*{8}} \put(25.5,52.25){\makebox(0,0)[rc]{$9$}}%9
\put(74,52){\makebox(0,0)[cc]{\Large \bf 12}} \put(74,52){\circle{40}} \end{picture}
\\
%TeXCAD Picture [1.pic]. Options:
%\grade{\on}
%\emlines{\off}
%\epic{\off}
%\beziermacro{\on}
%\reduce{\on}
%\snapping{\off}
%\pvinsert{% Your \input, \def, etc. here}
%\quality{8.000}
%\graddiff{0.005}
%\snapasp{1}
%\zoom{4.0000}
\unitlength 0.2mm % = 2.85pt
\allinethickness{1pt}%\linethickness{0.8pt}
\ifx\plotpoint\undefined\newsavebox{\plotpoint}\fi % GNUPLOT compatibility
\begin{picture}(132.5,122)(0,0)
\put(20,20){\line(1,0){110}}
%\emline(20,20)(75,110)
\put(20,20){\line(3,5){55}}
%\end
%\emline(75,110)(130,20)
\put(130,20){\line(-3,5){55}}
%\end
\put(129.75,20){\circle*{8}} \put(138,5){\makebox(0,0)[cc]{$4$}}      %4
\put(56.25,79.75){\circle*{8}} \put(42.5,80.25){\makebox(0,0)[rc]{$8$}}%8
\put(74,52){\makebox(0,0)[cc]{\Large \bf 13}} \put(74,52){\circle{40}} \end{picture}
&
%TeXCAD Picture [1.pic]. Options:
%\grade{\on}
%\emlines{\off}
%\epic{\off}
%\beziermacro{\on}
%\reduce{\on}
%\snapping{\off}
%\pvinsert{% Your \input, \def, etc. here}
%\quality{8.000}
%\graddiff{0.005}
%\snapasp{1}
%\zoom{4.0000}
\unitlength 0.2mm % = 2.85pt
\allinethickness{1pt}%\linethickness{0.8pt}
\ifx\plotpoint\undefined\newsavebox{\plotpoint}\fi % GNUPLOT compatibility
\begin{picture}(132.5,122)(0,0)
\put(20,20){\line(1,0){110}}
%\emline(20,20)(75,110)
\put(20,20){\line(3,5){55}}
%\end
%\emline(75,110)(130,20)
\put(130,20){\line(-3,5){55}}
%\end
\put(129.75,20){\circle*{8}} \put(138,5){\makebox(0,0)[cc]{$4$}}      %4
\put(38.75,51.25){\circle*{8}} \put(25.5,52.25){\makebox(0,0)[rc]{$9$}}%9
\put(74,52){\makebox(0,0)[cc]{\Large \bf 14}} \put(74,52){\circle{40}} \end{picture}
\end{tabular}
\caption{\label{2009-qcho-f2vs}
Two-valued states interpretable as global truth functions of the observables depicted
in Figure~\ref{2009-QvPRtria}(a). Encircled numbers count the states, smaller numbers
label the observables.
}
\end{figure}

\section{Noncommutative chocolate cryptography which cannot be realized quantum mechanically}

Quantum mechanics does not allow a ``triangular'' structure of observables similar to the one depicted in
Fig.~\ref{2009-QvPRtria} with {\em three} instead of four atoms per block (context),
since no geometric configuration of tripods exist in three-dimensional vector space which would satisfy this scheme.
(For a different propositional structure not expressible by quantum mechanics, see Specker's programmatic article~\cite{specker-60} from 1960.)
It contains six atoms $1,\ldots ,6$ in the blocks 1--2--3, 3--4--5, 5--6--1.
In order to obtain a partition logic on which the chocolate ball model can be based, the four two-valued states
are enumerated and depicted in Figure~\ref{2009-qcho-f2vs-2}.
\begin{figure}
\begin{center}
\begin{tabular}{cccccccccc}
%TeXCAD Picture [1.pic]. Options:
%\grade{\on}
%\emlines{\off}
%\epic{\off}
%\beziermacro{\on}
%\reduce{\on}
%\snapping{\off}
%\pvinsert{% Your \input, \def, etc. here}
%\quality{8.000}
%\graddiff{0.005}
%\snapasp{1}
%\zoom{4.0000}
\unitlength .2mm % = .569pt
\allinethickness{1pt}%\linethickness{0.8pt}
\ifx\plotpoint\undefined\newsavebox{\plotpoint}\fi % GNUPLOT compatibility
\begin{picture}(130,110)(0,0)
\put(20,20){\line(1,0){110}}
%\emline(20,20)(75,110)
\multiput(20,20)(.1198257081,.1960784314){459}{\line(0,1){.1960784314}}
%\end
%\emline(75,110)(130,20)
\multiput(75,110)(.1198257081,-.1960784314){459}{\line(0,-1){.1960784314}}
%\end
\put(20,20){\circle*{8}}
\put(15,5){\makebox(0,0)[cc]{$1$}}
%1
\put(102,66.25){\circle*{8}}
\put(111,73){\makebox(0,0)[lc]{$4$}}
%5
\put(74,52){\makebox(0,0)[cc]{\Large \bf 1}}
\put(74,52){\circle{40}}
\end{picture}
&
%TeXCAD Picture [1.pic]. Options:
%\grade{\on}
%\emlines{\off}
%\epic{\off}
%\beziermacro{\on}
%\reduce{\on}
%\snapping{\off}
%\pvinsert{% Your \input, \def, etc. here}
%\quality{8.000}
%\graddiff{0.005}
%\snapasp{1}
%\zoom{4.0000}
\unitlength .2mm % = .569pt
\allinethickness{1pt}%\linethickness{0.8pt}
\ifx\plotpoint\undefined\newsavebox{\plotpoint}\fi % GNUPLOT compatibility
\begin{picture}(138.75,110)(0,0)
\put(20,20){\line(1,0){110}}
%\emline(20,20)(75,110)
\multiput(20,20)(.1198257081,.1960784314){459}{\line(0,1){.1960784314}}
%\end
%\emline(75,110)(130,20)
\multiput(75,110)(.1198257081,-.1960784314){459}{\line(0,-1){.1960784314}}
%\end
\put(130,20){\circle*{8}}
\put(138.75,5){\makebox(0,0)[cc]{$3$}}
%1
\put(48.25,66.25){\circle*{8}}
\put(30,73){\makebox(0,0)[lc]{$6$}}
%5
\put(74,52){\makebox(0,0)[cc]{\Large \bf 2}}
\put(74,52){\circle{40}}
\end{picture}
&
%TeXCAD Picture [1.pic]. Options:
%\grade{\on}
%\emlines{\off}
%\epic{\off}
%\beziermacro{\on}
%\reduce{\on}
%\snapping{\off}
%\pvinsert{% Your \input, \def, etc. here}
%\quality{8.000}
%\graddiff{0.005}
%\snapasp{1}
%\zoom{4.0000}
\unitlength .2mm % = .569pt
\allinethickness{1pt}%\linethickness{0.8pt}
\ifx\plotpoint\undefined\newsavebox{\plotpoint}\fi % GNUPLOT compatibility
\begin{picture}(130,120.25)(0,0)
\put(20,20){\line(1,0){110}}
%\emline(20,20)(75,110)
\multiput(20,20)(.1198257081,.1960784314){459}{\line(0,1){.1960784314}}
%\end
%\emline(75,110)(130,20)
\multiput(75,110)(.1198257081,-.1960784314){459}{\line(0,-1){.1960784314}}
%\end
\put(74.25,20){\circle*{8}}
\put(74.25,6){\makebox(0,0)[cc]{$2$}}
%1
\put(75.25,109.75){\circle*{8}}
\put(75.75,123.25){\makebox(0,0)[cc]{$5$}}
%5
\put(74,52){\makebox(0,0)[cc]{\Large \bf 3}}
\put(74,52){\circle{40}}
\end{picture}
&
%TeXCAD Picture [1.pic]. Options:
%\grade{\on}
%\emlines{\off}
%\epic{\off}
%\beziermacro{\on}
%\reduce{\on}
%\snapping{\off}
%\pvinsert{% Your \input, \def, etc. here}
%\quality{8.000}
%\graddiff{0.005}
%\snapasp{1}
%\zoom{4.0000}
\unitlength .2mm % = .569pt
\allinethickness{1pt}%\linethickness{0.8pt}
\ifx\plotpoint\undefined\newsavebox{\plotpoint}\fi % GNUPLOT compatibility
\begin{picture}(130,110)(0,0)
\put(20,20){\line(1,0){110}}
%\emline(20,20)(75,110)
\multiput(20,20)(.1198257081,.1960784314){459}{\line(0,1){.1960784314}}
%\end
%\emline(75,110)(130,20)
\multiput(75,110)(.1198257081,-.1960784314){459}{\line(0,-1){.1960784314}}
%\end
\put(74.25,20){\circle*{8}}
\put(73,6){\makebox(0,0)[cc]{$2$}}
%1
\put(47.75,66){\circle*{8}}
\put(101.25,66){\circle*{8}}
\put(30,73){\makebox(0,0)[lc]{$6$}}
\put(110.25,73.5){\makebox(0,0)[lc]{$4$}}
%5
\put(74,52){\makebox(0,0)[cc]{\Large \bf 4}}
\put(74,52){\circle{40}}
\end{picture}
\end{tabular}
\end{center}
\caption{ \label{2009-qcho-f2vs-2}
Two-valued states on triangular propositional structure with three atoms per context or block.
}
\end{figure}

The associated partition logic is given by
$$
\begin{array}{c}
\{
\{
\{1
\},
\{2
\},
\{  3,4
\}
\}, \\
\{
\{1,4
\},
\{ 2
\},
\{ 3
\}
\}, \\
\{
\{ 1
\},
\{ 2,4
\},
\{ 3
\}
\}
\}.
\end{array}
$$
Every one of the three partitions of the set $\{1,\ldots ,4\}$ of ball types labeled by 1 through 4 corresponds to a color; and there are three symbols per colors.
For the first (second/third) partition, the propositions associated with these protocols are:
\begin{itemize}
\item
``when seen through light of the first (second/third) color (e.g., pink/light blue/yellow), symbol ``0'' means ball type number 1 (2/3);''
\item
``when seen through light of the first (second/third) color (e.g., pink/light blue/yellow), symbol ``1'' means ball type number 3 or 4 (1 or 4/2 or 4);''
\item
``when seen through light of the first (second/third) color (e.g., pink/light blue/yellow), symbol ``2'' means ball type number 2 (3/1).''
\end{itemize}
More explicitly, there are four ball types of the form
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(12,12)\put(6,2){\circle*{12}} \put(6,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 0}}{\color{Turquoise1} {\bf 1}}{\color{yellow} {\bf 2}}$}}\end{picture},
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(12,12)\put(6,2){\circle*{12}} \put(6,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 2}}{\color{Turquoise1} {\bf 0}}{\color{yellow} {\bf 1}}$}}\end{picture},
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(12,12)\put(6,2){\circle*{12}} \put(6,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 1}}{\color{Turquoise1} {\bf 2}}{\color{yellow} {\bf 0}}$}}\end{picture}, and
\unitlength 0.7mm \allinethickness{1pt}\begin{picture}(12,12)\put(6,2){\circle*{12}} \put(6,2){\makebox(0,0)[cc]{${\color{DeepPink1} {\bf 1}}{\color{Turquoise1} {\bf 1}}{\color{yellow} {\bf 1}}$}}\end{picture}.
The resulting propositional structure is depicted in Fig.~\ref{2009-QvPRtria-2}.
With respect to conceivable realizations,  cryptographic protocols -- such as the one sketched above -- based on this structure are ``stranger than quantum mechanical'' ones.
\begin{figure}
\begin{center}
%TeXCAD Picture [1.pic]. Options:
%\grade{\on}
%\emlines{\off}
%\epic{\off}
%\beziermacro{\on}
%\reduce{\on}
%\snapping{\off}
%\pvinsert{% Your \input, \def, etc. here}
%\quality{8.000}
%\graddiff{0.005}
%\snapasp{1}
%\zoom{4.0000}
\unitlength 0.3mm % = 2.85pt
\allinethickness{3pt}%\linethickness{0.8pt}
\ifx\plotpoint\undefined\newsavebox{\plotpoint}\fi % GNUPLOT compatibility
\begin{picture}(132.5,122)(0,0)
\put(20,20){\color{Turquoise1}\line(1,0){110}}
%\emline(20,20)(75,110)
\multiput(20,20)(.03372164316,.05518087063){1631}{\color{yellow}\line(0,1){.05518087063}}
%\end
%\emline(75,110)(130,20)
\multiput(75,110)(.03372164316,-.05518087063){1631}{\color{DeepPink1}\line(0,-1){.05518087063}}
%\end
\put(20,20){\color{Turquoise1}\circle{9}}
\put(20,20){\color{yellow}\circle{5.5}}
\put(20,20){\color{yellow}\circle{1.5}}
\put(74.375,20){\color{Turquoise1}\circle{5.5}}
\put(74.375,20){\color{Turquoise1}\circle{1.5}}
\put(129.75,20){\color{DeepPink1}\circle{9}}
\put(129.75,20){\color{Turquoise1}\circle{5.5}}
\put(129.75,20){\color{Turquoise1}\circle{1.5}}
\put(47.5,65.5){\color{yellow}\circle{5.5}}
\put(47.5,65.5){\color{yellow}\circle{1.5}}
\put(74.75,109.75){\color{yellow}\circle{9}}
\put(74.75,109.75){\color{DeepPink1}\circle{5.5}}
\put(74.75,109.75){\color{DeepPink1}\circle{1.5}}
\put(102.5,65.5){\color{DeepPink1}\circle{5.5}}
\put(102.5,65.5){\color{DeepPink1}\circle{1.5}}
\put(15,5){\makebox(0,0)[cc]{$\{1\}$}}
\put(74.375,5){\makebox(0,0)[cc]{$\{3,4\}$}}
\put(138,5){\makebox(0,0)[cc]{$\{2\}$}}
\put(74.75,122){\makebox(0,0)[cc]{$\{3\}$}}
\put(112,65.8){\makebox(0,0)[lc]{$\{1,4\}$}}
\put(34,65.8){\makebox(0,0)[rc]{$\{2,4\}$}}
\end{picture}
\end{center}
\caption{ \label{2009-QvPRtria-2}
(Color online)
Propositional structure allowing (value definite)
chocolate ball realizations with three atoms per context or block which does not allow a quantum analogue.
}
\end{figure}


\section{Summary and discussion}



It has been argued that value indefiniteness rather than complementarity should be used as a quantum resource
against cryptanalytic attacks.
One reason for this suggestion is that certain types of complementarity can be mimicked by quasi-classical configurations,
whereas there cannot exist a noncontextual (quasi-)classical analogue of quantum value indefiniteness.

The formal reason for the impossibility of (quasi-)classical models in the latter case is
the nonexistence of any two-valued measures on the propositional structure resulting from the associated observables; at least with the assumptions (e.g. noncontextuality) made.
Constructive proofs (by contradiction) of this formal result has yielded
Kochen-Specker type theorems~\cite{specker-60,kochen1,ZirlSchl-65,Alda,Alda2,kamber64,kamber65,mermin-93}.
By contrast, quantum complementarity may still allow observables and propositional structures with a sufficient
number of two-valued states to even allow a homeomorphic embedding into a classical Boolean algebra~\cite{svozil-ql}.
Configurations associated with merely statistical violations of Bell-type inequalities are in-between those two extremes
because they still allow ``a few'' two-valued states
which can be used for the coloring of certain types of chocolate balls;
however these states are insufficient to render a faithful embedding into Boolean algebras,
and at the same time incapable
of rendering the quantum violations of the associated Bell-type inequalities.
If in such cases one insists in tabling potential physical properties, these have to be contextual~\cite{svozil-2011-enough}.
Thus quantitatively -- that is in terms of the necessary violations of noncontextuality -- some of the protocols suggested here,
by explicitly using Kochen-Specker type constructions, utilize even ``more'' nonclassical resources of quantum mechanics
than the Ekert protocol based on Bell-type inequalities.

Whether this ``sharpening'' of nonclassicality can be considered an improvement over previous cryptographic protocols remains conjectural.
It may be objected that quantum complementarity suffices
as resource against cryptanalytic attacks,
and thus the original BB84 protocol needs not be amended.
Because if one accepts quantum complementarity as an axiom,  there is no necessity for any further ``improvement'' of security against cryptanalytic attacks.
To this criticism I respond with a performance of the original BB84 protocols
with chocolate balls~\cite{svozil-2005-ln1e}; or more formally,
by stating that configurations with just two outcomes leave open the possibility
of a quasi-classical explanation, as they cannot rule out the existence of
sufficiently many two-valued states in order to construct homeomorphisms,
that is,  structure-preserving maps between the quantum and classical observables.
A necessary condition for the quantum resource of value indefiniteness or contextuality is the presence of at least three mutually exclusive outcomes.
But even then, no proof of unconditional security of the new protocols can be given.

From a purely operational,  phenomenological point of view, all that can be measured are violations of certain statistical predictions.
There does not exist any direct way of simultaneously testing
this nonclassical quantum behavior on individual particles~\cite{svozil-2006-uniquenessprinciple},
even in the
Kochen-Specker~\cite{cabello:210401,kirch-09}
or Greenberger-Horne-Zeilinger~\cite{ghz,panbdwz} type configurations.
Nevertheless, in other research areas, such as for instance with regard to quantum random number generators, the additional security gained by monitoring value indefiniteness or
contextuality is often perceived as an advantage~\cite{PhysRevLett.85.3313,2008-cal-svo,svozil-2009-howto,10.1038/nature09008}.
In this sense, the new protocol may present some advantage over the BB84, and even the Ekert protocols.
Thus when it comes to fully  harvesting  the quantum, it might not be too unreasonable to utilize value indefiniteness,
one of its most ``mind-boggling'' features encountered if one assumes the physical relevance of nonoperational yet counterfactual observables.







$\;$\\
{\bf Acknowledgements}
\\
The author gratefully acknowledges discussions with Cristian Calude and Josef Tkadlec, as well as the criticism, comments and suggestions of two anonymous Referees.
He also enjoyed the kind hospitality of the {\it Centre for Discrete Mathematics
and Theoretical Computer Science (CDMTCS)} of the {\it Department of Computer Science at
The University of Auckland} where this manuscript has been conceived.
This work was also supported by {\it The Department for International Relations}
of the {\em Vienna University of Technology.}
The pink--light blue--yellow coloring scheme is by Renate Bertlmann; communicated to the author by Reinhold Bertlmann.


\bibliography{svozil}



\end{document}


According to questions raised by the first Referee, the term ``protected'' has been explained in more details by writing

"This might be perceived ambivalently as and advantage -- by being based upon only these two features --
yet at the same time not utilizing the full mind boggling capacities of quantum mechanics, since they are not ``protected''
(in terms of no-go theorems for local noncontextual nonexotic~\cite{pitowsky-82,meyer:99}
hidden variable models not allowing) by Bell- or Kochen-Specker type value indefiniteness."


According to questions raised by the first Referee, the short discussion of the Ekert protocol with regards to chocolate balls has been revised to

"As a result, if the Ekert protocol would be executed with chocolate balls instead of suitable quanta,
the data would not violate the classical bounds predicted by quantum theory, thereby dissatisfying essential criteria thereof.
In this respect the Ekert protocol fails for chocolate balls, thereby indicating potential cryptanalytic risks."

According to criticism raised by the second Referee on the different natures of quantum and quasi-classical complementarity -- I completely agree with these considerations -- I have added a paragraph stating

"When comparing BB84-type cryptography with quanta and chocolate balls, one has to keep in mind
that the similarities with respect to complementarity appear somewhat superficial with regards to the state of the objects communicated  {\em after} any measurement.
Because even if an eavesdropper, say Eve, sticks to the rules of the game by putting on colored eyeglasses,
any of her measurements would not affect or change the type of ball, and thus would not cause any {\em disturbance}  of the objects communicated,
thereby not causing any measurement errors between Alice and Bob.
This is different from quantum complementarity and quantum cryptography protected by it,
for if Eve would choose a different observable than Bob she would inevitably alter the state transferred.
This amounts to a disturbance which makes it possible for Alice and Bob to recognize Eve's cryptanalytic attack through occasional measurement errors;
at least if Eve is incapable of controlling the classical channel between the two.
Of course one could alleviate this deficiency of the quasi-classical analogue by requiring Eve not to communicate the original object received from Bob,
but by redrawing from the urn and
sending Alice another object consistent with Eve's measurement."


According to criticism raised by the second Referee I have eliminated the statement "as complementarity may not be a sufficient resource for the type of ``objective'' security envisaged by quantum cryptography" and substituted it by a more formal argument in the concluding section. I have also stressed the potential advantages of the new protocol over others.

In the concluding section I have also mentioned that no proof for unconditional security of the new protocol can be given, as anticipated and expressed by the second Referee.

According to a question of the second Referee, I have added a small note on why I prefer the term "value indefiniteness" over the term "contextuality": it is basically because the former term is more general, whereas the latter one implies a particular quasi-realist way of "solution" or "interpretation" of the Bell- and Kochen-Specker type theorems.

According to the suggestion of the second Referee, I have added value indefiniteness and contextuality  as keywords.

According to the suggestion of the second Referee, I have eliminated several typos or grammar mistakes (e.g. an"d" advantage, bas"i"s, G"l"eason, theorem"s" ...).

According to the suggestion of the second Referee, instead of "(they share the trivial origin)" it is noted "(they do not share any vector)."

According to the suggestion of the second Referee, I have explicitly written down "Boolean algebra with two (four) atoms" instead of "2^2" ("2^4").

According to the suggestion of the second Referee, I have added references and shortly explained pastings of subalgebras, partition logics, and added references to orthocomplemented propositional structure as well as Greechie diagram.

According to the suggestion of the second Referee, I have written "b_2=b_1'" (prime) instead of "b_2=b_1."

According to the suggestion of the second Referee, I have corrected the grammar to "or in both of them  (i.e., in $L_A \cap L_B$)."

According to the suggestion of the second Referee, I have explained "dispersionless."

According to the suggestion of the second Referee, I have eliminated the quotation marks from "at its most mind-boggling mode."

Motivated by the criticism of the second Referee, I have rewritten the statement as follows:

"most of the present random number generators using beam splitters are protected by the randomness
of single outcomes as well as by complementarity, but not by certified value indefiniteness" and cited the paper mentioned by the Referee (among others).

According to the suggestion of the second Referee, I have changed "Alas" to "Fortunately."

According to the suggestion of the second Referee, I have changed the wording to

"... the question of whether it is {\em sufficient} for this purpose to compose a multiport beam splitter
by a succession of phase shifters and beam splitters
with two output ports~\cite{rzbb,svozil-2004-analog},
based on elementary decompositions of the unitary group~\cite{murnaghan} remains to be answered."

According to the suggestion of the second Referee, I have corrected a passage to

"Suppose one would nevertheless attempt to ``mimic'' an Ekert type protocol
proposed by Bennett, Brassard and Mermin (BBM92)~\cite{PhysRevLett.68.557} ..."

According to the suggestion of the second Referee, I have corrected the label discrepancies between figures 2 and 3.

According to the suggestion of the second Referee, I have now written in figure caption of figure 2.

"vectors whose linear span can be identified with propositions~\cite{birkhoff-36}"

According to the suggestion of the second Referee, I have substituted "Indeed" for "For"

According to the suggestion of the second Referee, I have changed the text to

"Bob independently from Alice, picks some (not necessarily different from Alice's) basis at random"

According to the suggestion of the second Referee, I have eliminated the term "remaining" because this may give rise to confusions.

According to the suggestion of the second Referee, I have changed "that is does" to "that it does."

According to the suggestion of the second Referee, I have eliminated the bracket containing "partner" because this may give rise to confusions.

Following the criticism of the second Referee, I have now written "For the sake of an explicit demonstration, a simplified version of the protocol, ..."

Finally, as mentioned earlier, I have completely rewritten the summary section with  particular emphasis on the criticism put forward by the second Referee.


